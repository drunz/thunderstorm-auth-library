Thunderstorm Auth Library
=========================

Thunderstorm auth library assists in using [JWTs](https://jwt.io/) generated by the
[Thunderstorm User Service](https://github.com/artsalliancemedia/thunderstorm-user-service).


Requirements
------------

You will need to include the config variable `TS_AUTH_SECRET_KEY` in your Flask config. During beta
phase, the value for this can be retrieved from the
[Thunderstorm User Service](https://github.com/artsalliancemedia/thunderstorm-user-service#using-your-jwt).


How to Use
----------

The following decorator will make your views require the JWT issued by the `thunderstorm-user-service`.

```python
@route('/hello', methods=['GET'])
@ts_auth_required
def hello():
    return jsonify({'message': 'hello world'})
```

When making a request to this endpoint, you must supply your JWT in a HTTP header called
`X-Thunderstorm-Key`.

For example:

```
$ http localhost:8888/hello X-Thunderstorm-Key:eyJ0eXAiOiJKV1QiLCJhbGciOiJIUzI1NiJ9.eyJ1c2VybmFtZSI6Im1hZnJvMiIsInBlcm1pc3Npb25zIjoiKiIsImV4cCI6MTUwMTg0NTk0OH0.uhRFnfqIaZ91A5xgbqKqQPjdBuOYsuMzIEHA7-j0mzM
HTTP/1.0 200 OK
Content-Length: 31
Content-Type: application/json
Date: Fri, 04 Aug 2017 09:55:19 GMT
Server: Werkzeug/0.12.2 Python/3.5.3

{
    "message": "hello world"
}
```

When authentication fails:

```
$ http localhost:8888/hello X-Thunderstorm-Key:egg
HTTP/1.0 401 UNAUTHORIZED
Content-Length: 48
Content-Type: application/json
Date: Fri, 04 Aug 2017 11:37:40 GMT
Server: Werkzeug/0.12.2 Python/3.5.3

{
    "message": "Token authentication failed."
}
```

If this header is missing, the request will receive a 401:

```
$ http localhost:8888/hello
HTTP/1.0 401 UNAUTHORIZED
Content-Length: 53
Content-Type: application/json
Date: Fri, 04 Aug 2017 09:55:24 GMT
Server: Werkzeug/0.12.2 Python/3.5.3

{
    "message": "Missing X-Thunderstorm-Key header"
}
```


Exceptions
----------

The exception `AuthSecretKeyNotSet` will be raised when `TS_AUTH_SECRET_KEY` is missing from the
Flask config. 
